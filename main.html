<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
  </head>
  <body>
    <script src="js/lib_ubuntuone.js"></script>
    <script src="js/lib_controller.js"></script>
    <input id="search" name="search" />
    <input type="file" id="files" name="files" />
    <audio id="player" controls></audio>
    <img id="coverArt" src="" width="100"></img>

    <!-- select id="artistsBox" size="10" multiple></select -->
    <!-- select id="albumsBox" size="10" multiple></select -->
    <select id="songBox" size="10"></select>

    <script>
      function startPlay(event) {
        var song = JSON.parse(event.target.value);
	      var audio = document.getElementById('player');
	      audio.type = song.contentType;
	      audio.src = "https://streaming.one.ubuntu.com/rest/stream.view?u=" +JSON.parse(localStorage["authentication.login"])+ "&p=" +JSON.parse(localStorage["authentication.password"])+ "&v=1.2.0&c=chrome&id=" + song.id;

	      var image = document.getElementById('coverArt');
        image.src = "https://streaming.one.ubuntu.com/rest/getCoverArt.view?u=" + JSON.parse(localStorage["authentication.login"]) + "&p=" +JSON.parse(localStorage["authentication.password"])+ "&v=1.2.0&c=chrome&id=" +song.coverArt;
      }
      document.getElementById('songBox').addEventListener('change', startPlay, false);
    
      function handleFileSelect(evt) {
        var files = evt.target.files;
        for (var i = 0, f; f = files[i]; i++) {
	        var reader = new FileReader();
	        reader.onload = function(evt) {
	          var audio = document.getElementById('player');
	          audio.src = evt.target.result;
	        };
	        reader.readAsDataURL(f);
        }
      }
      document.getElementById('files').addEventListener('change', handleFileSelect, false);

      function startSearch(event) {
        searchForSongs(event.target.value, collectSongs, null, null);
      }
      document.getElementById('search').addEventListener('change', startSearch, false);
    </script>
    <script>
    // var audio = document.getElementById('player');
	  // audio.src = "https://streaming.one.ubuntu.com/rest/stream.view?u=" + JSON.parse(localStorage["authentication.login"]) + "&p=" +JSON.parse(localStorage["authentication.password"])+ "&v=1.2.0&c=chrome&id=egdeYJc0TcCw8hKOXRtEtg%3AYqtNiX5VTdeuBC3aCPr79g&maxBitRate=0";
	  // audio.type = "audio/mp3";

	  // getArtists(1, collectArtists, null, null);
	  // getAlbums("ad0ee8280b27b55c6660af6bc4884d0a", collectAlbums, null, null);
	  </script>
  </body>
</html>
